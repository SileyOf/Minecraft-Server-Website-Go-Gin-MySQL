<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸–ç•Œåœ°å›¾ - HXZD</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/sao-buttons.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="custom-bg" id="customBg"></div>
    <nav class="sao-nav" id="saoNav">
        <div class="sao-nav-container">
            <a href="index.html" class="sao-btn" data-index="0"><span class="sao-btn-icon">âŒ‚</span><span class="sao-btn-text">Home</span><span class="sao-btn-diamond"></span></a>
            <a href="gameplay.html" class="sao-btn" data-index="1"><span class="sao-btn-icon">âš”</span><span class="sao-btn-text">ç©æ³•</span><span class="sao-btn-diamond"></span></a>
            <a href="map.html" class="sao-btn active" data-index="2"><span class="sao-btn-icon">ğŸ—º</span><span class="sao-btn-text">ä¸–ç•Œåœ°å›¾</span><span class="sao-btn-diamond"></span></a>
            <a href="announcements.html" class="sao-btn" data-index="3"><span class="sao-btn-icon">ğŸ“¢</span><span class="sao-btn-text">å…¬å‘Š</span><span class="sao-btn-diamond"></span></a>
            <a href="forum.html" class="sao-btn" data-index="4"><span class="sao-btn-icon">ğŸ’¬</span><span class="sao-btn-text">å¾®è®ºå›</span><span class="sao-btn-diamond"></span></a>
            <a href="about.html" class="sao-btn" data-index="5"><span class="sao-btn-icon">â„¹</span><span class="sao-btn-text">å…³äº</span><span class="sao-btn-diamond"></span></a>
            <a href="status.html" class="sao-btn" data-index="6"><span class="sao-btn-icon">â—‰</span><span class="sao-btn-text">æœåŠ¡å™¨çŠ¶æ€</span><span class="sao-btn-diamond"></span></a>
            <a href="sponsor.html" class="sao-btn" data-index="7"><span class="sao-btn-icon">â™¥</span><span class="sao-btn-text">èµåŠ©</span><span class="sao-btn-diamond"></span></a>
            <a href="login.html" class="sao-btn sao-btn-login" data-index="8" id="navAuthBtn"><span class="sao-btn-icon">â–¸</span><span class="sao-btn-text">ç™»å½•</span><span class="sao-btn-diamond"></span></a>
        </div>
    </nav>
    <div class="particles" id="particles"></div>

    <main class="main-content">
        <div class="sao-panel content-page">
            <div class="sao-panel-header"><span class="sao-panel-diamond"></span><span>WORLD MAP</span></div>
            <div class="page-body" id="worldMapContainer"><div class="loading-placeholder">åŠ è½½ä¸­...</div></div>
        </div>
    </main>
    <div class="sao-corner top-left"></div>
    <div class="sao-corner bottom-right"></div>

    <script src="js/common.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', async () => {
        HXZD.initNav();
        await HXZD.loadBackground();
        try {
            const res = await fetch(HXZD.API + '/world-maps');
            const maps = await res.json();
            const container = document.getElementById('worldMapContainer');
            if (!maps || maps.length === 0) {
                container.innerHTML = '<p style="color:var(--sao-text-muted)">æš‚æ— åœ°å›¾</p>';
                return;
            }
            let html = '';
            const first = maps[0];
            html += `<div class="world-map-default">
                <h3 style="margin-bottom:12px;font-size:0.95rem">ğŸ—ºï¸ ${HXZD.escapeHtml(first.name)}</h3>
                ${first.embed_url ? `<iframe src="${HXZD.escapeHtml(first.embed_url)}" frameborder="0" allowfullscreen loading="lazy"></iframe>` : '<p style="color:var(--sao-text-muted)">åœ°å›¾ URL æœªé…ç½®</p>'}
            </div>`;
            for (let i = 1; i < maps.length; i++) {
                const m = maps[i];
                html += `<div class="map-collapse-item">
                    <button class="map-collapse-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('open')">
                        <span class="toggle-arrow">â–¸</span> ${HXZD.escapeHtml(m.name)}
                    </button>
                    <div class="map-collapse-body">
                        ${m.embed_url ? `<iframe src="${HXZD.escapeHtml(m.embed_url)}" frameborder="0" allowfullscreen loading="lazy"></iframe>` : '<p style="color:var(--sao-text-muted);padding:12px">åœ°å›¾ URL æœªé…ç½®</p>'}
                    </div>
                </div>`;
            }
            container.innerHTML = html;
        } catch(e) { document.getElementById('worldMapContainer').innerHTML = '<p>åŠ è½½å¤±è´¥</p>'; }
    });
    </script>
    <script src="js/particles.js"></script>
</body>
</html>
